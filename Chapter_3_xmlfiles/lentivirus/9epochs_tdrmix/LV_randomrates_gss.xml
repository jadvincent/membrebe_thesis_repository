<?xml version="1.0" standalone="yes"?>

<!-- Generated by BEAUTi v1.8.4                                              -->
<!--       by Alexei J. Drummond, Andrew Rambaut and Marc A. Suchard         -->
<!--       Department of Computer Science, University of Auckland and        -->
<!--       Institute of Evolutionary Biology, University of Edinburgh        -->
<!--       David Geffen School of Medicine, University of California, Los Angeles-->
<!--       http://beast.bio.ed.ac.uk/                                        -->
<beast>

<!-- NOTE: Version 3 contains the HKY model as opposed to the GTR model in the previous versions -->
	<!-- The list of taxa to be analysed (can also include dates/ages).          -->
	<!-- ntax=43                                                                 -->
	<taxa id="taxa">
		<taxon id="CAEV"/>
		<taxon id="Visna"/>
		<taxon id="SmallRuminant"/>
		<taxon id="EIAV"/>
		<taxon id="EIAV_Li"/>
		<taxon id="Jembrana"/>
		<taxon id="BIV"/>
		<taxon id="FIV_Oma"/>
		<taxon id="FIV_CoLV"/>
		<taxon id="FIV_Puma"/>
		<taxon id="FIV_Pco"/>
		<taxon id="FIV_Lru"/>
		<taxon id="FIV_P"/>
		<taxon id="SIVcol"/>
		<taxon id="HIV1_N"/>
		<taxon id="HIV1O"/>
		<taxon id="SIVskyes"/>
		<taxon id="SIVagm"/>
		<taxon id="SIVagm_sab"/>
		<taxon id="SIVagm_tan"/>
		<taxon id="HIV2_BEN"/>
		<taxon id="SIVsmm"/>
		<taxon id="SIVmon"/>
		<taxon id="SIVcpz"/>
		<taxon id="SIVgsn"/>
		<taxon id="SIVlhoest"/>
		<taxon id="SIVsun"/>
		<taxon id="SIVdrl"/>
		<taxon id="SIVdrl_DRL38_Bioko"/>
		<taxon id="SIVmnd"/>
		<taxon id="SIVmnd5440"/>
		<taxon id="SIVcpz_tan3"/>
		<taxon id="SIVrcm"/>
		<taxon id="HIV_1_hxb2"/>
		<taxon id="A1_KE_AF457053_2000"/>
		<taxon id="A2_CD_AF286238_1997"/>
		<taxon id="A3_SN_AY521631_2001"/>
		<taxon id="A6_RU_EF545108_2000"/>
		<taxon id="B_US_FJ469707_2007"/>
		<taxon id="C_ZA_AY878064_2003"/>
		<taxon id="D_UG_JX236679_2007"/>
		<taxon id="F1_BR_AB485657_1990"/>
		<taxon id="F2_CM_AY371158_2002"/>
	</taxa>
	<taxa id="HIVM">
		<taxon idref="A1_KE_AF457053_2000"/>
		<taxon idref="A2_CD_AF286238_1997"/>
		<taxon idref="A3_SN_AY521631_2001"/>
		<taxon idref="A6_RU_EF545108_2000"/>
		<taxon idref="B_US_FJ469707_2007"/>
		<taxon idref="C_ZA_AY878064_2003"/>
		<taxon idref="D_UG_JX236679_2007"/>
		<taxon idref="F1_BR_AB485657_1990"/>
		<taxon idref="F2_CM_AY371158_2002"/>
		<taxon idref="HIV_1_hxb2"/>
	</taxa>
	<taxa id="drill">
		<taxon idref="SIVdrl"/>
		<taxon idref="SIVdrl_DRL38_Bioko"/>
	</taxa>

	<!-- The sequence alignment (each sequence refers to a taxon above).         -->
	<!-- ntax=43 nchar=420                                                       -->
	<alignment id="alignment" dataType="nucleotide">
		<sequence>
			<taxon idref="CAEV"/>
			GAAAAAGTAAAAGGAGAATCAGGGCAAGAATTCAGAATAAAAGTGATGCATTGGTATGCATTATTTGGTCCAGAGTCATTGCAGTCAGACAATGGACCTGCATTTGCAGCAGAGCCCACACAGCTGTTAATGCAATACCTAGGAGTAAAACACACAACAGGCATACCTTGGAATCCACAGTCTCAGGCTATAGTAGAAAGGGCACATCAACTATTGAAAAGCACTTTAAAGAAGTTCCAGCCACAATTTGTCGCTGTAGAATCAGCCATAGCAGCAGCCCTAGTCGCCATAAATATAAAAAGAAAGGGTGGGCTGGGG---ACAAGCCCTATGGATATTTTTATATATTTCTGTTATTACAGAATANAGTGGAAAGGACCAACCCAGGTACTGTGGAAAGGGGAAGGAGCCAATTGTGGT
		</sequence>
		<sequence>
			<taxon idref="Visna"/>
			GAGAGGGTAAAAGGAGAAACAGGACAAGAATTTAGGGTGCAAACTATGAAATGGTATGCGATGTTTGCCCCGAAATCATTGCAGTCTGATAACGGACCAGCATTTGTAGCAGAATCTACTCAGCTCTTAATGAAATATTTGGGCATAGAACATACTACAGGGATCCCCTGGAACCCACAATCTCAAGCATTAGTAGAGAGAACACATCAGACGTTAAAGAATACATTAGAAAAACTTATACCTATGTTTAACGCGTTTGAATCAGCCCTCGCAGGGACCCTCATTACTCTAAATATAAAAAGAAAGGGTGGGCTAGGG---ACAAGCCCTATGGATATATTTATATTTTTTTGTTATTACAGAACAGAGTGGCAAGGACCAACACAGGTACTTTGGGGCGGGGACGGTGCGATTGTAGTG
		</sequence>
		<sequence>
			<taxon idref="SmallRuminant"/>
			GAAAGGGTAAAAGGGGAAACAGGGCAAGAATTTAGAATCCAAGTTATGAAATGGTACTCTATGTTTGATCCAAAATCATTGCAGTCGGATAATGGACCTGCGTTTATTGCAGAACCTACACAGCTCTTGATGAAATATTTGGGAATAGAACACACAACGGGAATCCCGTGGAATCCCCAATCACAGGCCTTAGTGGAAAGGGCACATCAAACGTTAAAACACACTTTGGAAAAATTTGTTCCCATGTTTGTTGCATTTGAATCTGCTCTTGCTGCGGCACTAATAGCTCTAAATATAAAAAGAAAGGGTGGGCTAGGG---ACAAGCCCTATGGACATATTTATATTTTTTTGTTATTACAGAATCGACTGGCTTGGACCAACTCAGGTACTCTGGGAAGGGGACGGAGCTATAGTTGTG
		</sequence>
		<sequence>
			<taxon idref="EIAV"/>
			ACATTATTATCAAAAGAAAATGCATTATGTACTTCATTGGCTATTTTAGAATGGGCAAGATTGTTTTCACCAAAGTCCTTACACACAGATAACGGCACTAATTTTGTGGCAGAACCAGTTGTAAATTTGTTGAAGTTCCTAAAGATAGCACATACCACAGGAATACCATATCATCCAGAAAGTCAGGGTATTGTAGAAAGGGCAAATAGGACCTTGAAAGAGAAGATTCAAAGTCATAGAGACAACACTCAAACACTGGAGGCAGCTTTACAACTTGCTCTCATTACTTGTAAC---AAAGGGAGGGAAAGTATGGGAGGACAGACACCATGGGAAGTATTTATCACTTTTTGTTTTTACAAAATCGATTGGAAGGGACCTACTAGGGTGCTGTGGAAGGGTGATGGTGCAGTAGTAGTT
		</sequence>
		<sequence>
			<taxon idref="EIAV_Li"/>
			ACTCTATTGTCCAAAGAAAATGCCTTGTGTACTTCATTGGCTATTTTGGAATGGGTGAGGTTATTTTCTCCTAAATCTTTACATACAGACAATGGTACTAATTTTGTAGCAGAGTCAGTAGCAAATCTGTTGAAATTCCTGAAGGTGACACATACTACAGGAATACCTTATCACCCAGAGAGCCAAGGCATTGTGGAAAGGGCAAACAGGACATTAAAAGAAAAAATTAAAAGTCATAGAGAAAATACTCAGACACTTGAAGCAGCATTACAACTTGCTCTCATTACTTGTAAC---AAAGGGAGGGAAAGTATGGGAGGACAAACTCCATGGGAAGTATTTATTACTTTTTGTTTTTATAAAATTAATTGGAAGGGGCCCACCAGAGTATTGTGGAAAGGTGATGGAGCAGTAGTGGTC
		</sequence>
		<sequence>
			<taxon idref="Jembrana"/>
			CGGGTTATTCCAGAAGAAAGCGCACAATCAATAGTGTTTTGCATTTTAATGCTCGTATACAGGTACACCGTATACCACATACATAGTGACAACGGGCCCTGTTTCATAGCACAAAAAGTAGAAGCCTTATGTAAGTATCTAAAGATTACTAAAACAACTGGTATACCTTACAACCCTCAAGCACAAGCTATAGTAGAAAGAACACACAGAGACATCAAAGATAAAATAGCAGCATTTAGGGAAGATTGTGAGACAGTAGAGGCGGCTTTGAGCCTGACCCTAGTGGCCCTAAAT---AAAAAAAGAGGGGGAATAGGGGGTCATACCCCATATGAAATATACCTAGAATGGGCCTATGTTAGGGACGTATGGAAAGGACCATACAAAGTCCTATGGGACGGAGAAGGGGCAGCAGTGGTA
		</sequence>
		<sequence>
			<taxon idref="BIV"/>
			CAGGTGATCCCTGAAGAAACAGCACTACAAGTAGCTCTCTGCATTTTACAGCTAATCCAGAGATATACAGTTCTTCACTTACATAGTGACAACGGGCCGTGCTTTACTGCACACAGGATAGAAAATCTATGTAAGTATCTGGGGATCACAAAAACTACGGGAATACCCTACAACCCACAATCCCAGGGAGTTGTAGAAAGAGCCCACAGAGATCTAAAAGACAGATTGGCAGCTTATCAGGGAGATTGTGAAACCGTAGAAGCAGCCCTTAGCCTCGCATTAGTTTCTTTAAAT---AAAAAAAGAGGGGGAATAGGGGGCCATACACCATATGAAATATACCTAGAATGGTGTTACGTAAGGAACGAATGGAAAGGACCCTACAAAGTGTTGTGGGACGGAGACGGGGCAGCAGTAATA
		</sequence>
		<sequence>
			<taxon idref="FIV_Oma"/>
			AGAATAATTCCTCAAGAGACAGCAGATATGACAGTAAAATATCTATTACAATTAATCTCGGAGCATCATGTGACTGAATTACAATCAGATAATGGACCAAATTTTAATAATGCAAAAGTAGAAGGCATGACAGGATTTTTGGGAATAAAACATAAATATGGAATTCCAGGAAACCCTCAATCACAAGCCTTGGTAGAAAATACCAATAGAATGTTAAAAGAATGGATAAAGAAATTTAGAGGGGAAGTAACTACTTTGGATGCAGCATTGGCACTTGCACTTTATGCTCTTAACTTTAAACAAAGGGGTAGAATAGGGAGAATATCCCCATATGAGTTACTTATACAGTGGATTTATTATAAGGATGAATGGAAGGGTCCAACACAGGTAGAATATTGGGGACAAGGAGCAGTTTTAATA
		</sequence>
		<sequence>
			<taxon idref="FIV_CoLV"/>
			AAAATATTGAAACAAGAAACAGCAAAAGAAACTGTATTAGCTATTTTAGAATTAATTCAGACACATAATGTAATAGAAATTCAAACAGATAATGGACCTAATTTTTCAAATTCAAGAATGGAAGGATTAACGGCACTTTTGGGAATAAATCACAAATTTGGAATACCGCTTAATCCTCAGAGTCAAGCTTTAGTGGAAAATATAAATAATACACTAAAGAATTGGATAAAAAAATTTAGATCAGAAGTAGAAACATTACAAGCAGCAGTGGCATTAGCTGTATTCGCTCTTAATAAAAAAAGAAAGGGTAATATAGGGGGTAGGACACCTTATGAGTTGTATATATGGTGGATTTATTATAAAGACGTATGGAAAGGCCCTAGACAGGTAATATACTGGGGAGAAGGCTCAGTCCTTATT
		</sequence>
		<sequence>
			<taxon idref="FIV_Puma"/>
			TACAATCTAAAAAGGGAAGATGCTAAAGAGACTGGATTAGCCTTTTTGAATTTGTTTAGCCAATATTATGTCACTGAGATACAAACTGATAATGGACCAAACTTTGCTAATGAGAGGATTACTGGTATTTGTTTTCATTTTGGAATAAAGCATAAGAAGGGAATTCCAATAAATCCTCAGTCTCAAGCATTAGTTGAAAATTTCAATCGAACATTAAAAGTATGGGTAGACAAATTTAAAGAAGTTACTGAAACTTTAGAAGCTGCAGTACAACTTGCAGTTCATGCTCTCAATCATAAAAGAAAGGGTGGATTAGGGGGTATTACACCCTATGAGCTTTATGTACAATGGATTTATTATAAGGATCTATGGAAAGGTCCCACGCAAGTCTATTATTGGGGTGAAGGAGCAGTATTAATT
		</sequence>
		<sequence>
			<taxon idref="FIV_Pco"/>
			AAGATTCTGAAACAAGAGACAGCCAAAGAAACAGTATTAGCTTTGTTGGAATTAATACAAACGCATAATGTTGTAGAAATTCAAACAGATAATGGTCCTAATTTTGCCAACTCCAGAATGGAAGGTCTCACTTCTTTTATGGGAATAAATCATAAATTTGGAATCCCTCTGAACCCACAAAGCCAAGCACTCGTAGAAAATATTAACAATACTTTAAAACAGTGGATAAAGAAATTTAGACAAGAAGTAGAAACATTACAAGCAGCTGTTGCATTAGCCACCTTTGCTCTCAATAAAAAAAGAAAGGGTAATATAGGGGGTATGTCTCCCTATGAGCTGTATATTTGGTGGATATATTATAAAGATGAATGGAAAGGCCCAGTACCAGTTATATATTGGGGAGAAGGATCAGTTTTGATT
		</sequence>
		<sequence>
			<taxon idref="FIV_Lru"/>
			TACAATCTAAAAAGAGAAGATGCCAAAGAAACTGGATTATCTTTTTTAAATTTATTCAGCCAATATTATGTGACTGAAATACAAACTGATAATGGCCCAAATTTTGCCAATGAAAGAATCACGGGTATTTGCTTTCACTTTGGAATAAAACATAAAAAAGGAATTCCTCTAAATCCACAGTCACAAGCATTAGTAGAAAATTATAATAAAACATTAAAAATTTGGATAGACAAATTTAGAGAAGCTACAGAGACTTTAGAAGCTGCTGTACAACTTGCAGTACATGCTCTTAATCAAAAAAGAAAGGGTGGATTAGGGGGTATTACACCGTATGAACTATATGTACAATGGATTTATTATAAGGACCAGTGGAAAGGTCCAACACAGGTTTATTATTGGGGGGAAGGAGCAGTATTAATT
		</sequence>
		<sequence>
			<taxon idref="FIV_P"/>
			CAAATAATTTCTCAAGAAACTGCTGACTGTACAGTTAAAGCTGTCTTACAATTGTTGAGTGCTCATAATGTTACTGAATTACAAACAGATAATGGACCAAATTTTAAAAATCAAAAGATGGAAGGAGTACTCAATTACATGGGTGTGAAACATAAGTTTGGTATCCCAGGGAACCCACAGTCACAAGCATTAGTTGAAAATGTAAATCATACATTAAAAGTTTGGATTCGGAAATTTTTGCCTGAAACAACCTCCTTGGATAATGCCTTATCTCTCGCTGTACATAGTCTCAATTTTAAAAGAAGAGGTAGGATAGGAGGGATGGCCCCTTATGAATTATTAGCACAATGGATTTATTATAAAGATAAATGGAAAGGACCAATGAGAGTAGAATACTGGGGACAGGGATCAGTATTATTA
		</sequence>
		<sequence>
			<taxon idref="SIVcol"/>
			ACCATATTAAAGAGAGAAACAGGGGAAGAAACAGGTAGGGCCCTCATAAAATTGGCTAGTCAGTGGGAGGTTAGACAAGTTCACACAGATAATGGGCCAAATTTTGTAAGTCAGCACTTTAAGGCAGCAGTGTGGTGGCTAGGAATAGCACACACCACAGGACACCCCTATAATCCTCAATCACAAGGAGTTGTAGAGCAGAGAAACAAGGATGTTAAAAGAAAGATTAAGAAAATGAAAGATCAAGCAGAAACATTAGAAAGCAAAGTAGCAATGGCAGTCTATGCGCTCAATTTTAAAAGAAAGGGAGGATTAGGGGGGAAGAGTCCATGGGAAAGACAAGTAGAAAAGGCCTACTGGAAAGAGGAGTGGCAAGGACCAGGAGAACTGGTGTGGAAAGGTGAAGGAGCGGTAGTCATC
		</sequence>
		<sequence>
			<taxon idref="HIV1_N"/>
			GAAGTTATTCCTGCAGAAACAGGACAGGAAACAGCATATTTTATTTTAAAGTTAGCTGGAAGATGGCCAGTAAAAGTTATACACACTGATAATGGACCCAATTTCACTAGTGCCACTGTAAAAGCAGCCTGTTGGTGGGCAAGTATCAAACAGGAATTCGGGATACCCTACAATCCTCAAAGTCAGGGAGCAGTAGAGTCCATGAATAAAGAATTAAAGAAAATTATAGGACAAATCAGAGATCAAGCAGAACATCTAAAAACAGCAGTGCAAATGGCAGTCTTCATTCACAATTTTAAAAGAAAAGGGGGGATTGGGGGGTACACTGCAGGGGAGAGAATAATAGACCGGGTTTATTACAGAGACATTTGGAAAGGACCAGCCAAACTTCTGTGGAAAGGAGAAGGGGCAGTGGTAATC
		</sequence>
		<sequence>
			<taxon idref="HIV1O"/>
			GAAGTGATACCAGCAGAAACAGGACAAGAAACTGCCTACTTCCTGTTAAAACTGGCTGCAAGATGGCCTGTTAAAGTAATACATACAGACAACGGGCCTAATTTTACAAGTACAACTATGAAGGCTGCATGTTGGTGGGCCAACATACAACATGAGTTTGGAATACCATATAATCCACAAAGTCAAGGAGTAGTAGAAGCCATGAATAAGGAATTAAAATCAATTATACAGCAGGTGAGGGACCAAGCAGAACACTTAAGAACAGCAGTACAAATGGCAGTATTTGTTCACAATTTTAAAAGAAAAGGGGGGATTGGGGGGTACACTGCAGGAGAAAGGATAATAGACCGGGTCTATTACAGAGACATCTGGAAAGGACCGGCACAGCTCCTGTGGAAAGGTGAGGGAGCAGTAGTCATA
		</sequence>
		<sequence>
			<taxon idref="SIVskyes"/>
			AAGATCTTAAAAAGGGAAACGGGGGATGAAACAGCATTGTTTCTCATGCAAATAGCCAGTAGATGGCCAATAAAACAGATACACACTGATAATGGACCAAACTTTGTCAGTGACAAGTTCAAAGCAGCATGTTGGTGGTGTGGCATAGAACACACTACAGGTATTCCATACAACCCACAAAGCCAGGGAATAGTAGAGTCCAAAAATAGGTATTTAAAAGAAGCTATCTCACAAATTAGAGACGACGTCACACATTTGCAAACAGCAGTGGCAATGGCAACCTTCATCTTAAATTTTAAAAGAAAGGGAGGAATAGGGGGGATATCACCAGGAGAAAGGTACATTAATAGGGTTTACTACCGCCAGGAGTGGAAGGGACCAGCTCGTCTACTTTGGAAAGGTGAAGGTGCAGTAGTGGTG
		</sequence>
		<sequence>
			<taxon idref="SIVagm"/>
			GAAGTTATACCTAGAGAAACAGGGAAAGAAACAGCAAAATTTTTATTAAAGATACTAAGTAGATGGCCCATAACCCAACTGCATACAGACAATGGACCCAATTTTACGTCTCAAGAAGTAGCAGCAATGTGTTGGTGGGGAAAAATAGAACACACCACAGGTGTACCCTATAACCCTCAATCACAAGGCTCTATAGAGAGTATGAATAAACAGTTAAAAGAAATAATTGGGAAAATAAGAGATGACTGTCAATACACAGAAACAGCAGTACTTATGGCATGCCACATCCACAATTTTAAAAGAAAGGGAGGAATAGGGGGGTTAACACCGGCAGAGAGATTAATCAATAGAGTCTACTACAGAGAAGTCTGGAAAGGACCAGGACAGTTAATTTGGAAAGGGGAAGGTGCAGTGGTCATC
		</sequence>
		<sequence>
			<taxon idref="SIVagm_sab"/>
			GAAGTAATCCCACAGGAAACAGGAAAAGCTACAGCACACTTCCTGCTGAAGTTAGCCAGCAGATGGCCCATCACACAGCTGCATACAGATAATGGTACCAACTTTACTAGCCAGCAAGTAGCAGCTATTTGCTGGTGGGGAAAAATAGAGCACACATTTGGGGTACCCTACAACCCCCAAAGTCAGGGAGTAGTAGAATCTATGAATAAGCAGTTAAAAGAAATCATAGGACAAATTAGAGATGATGCAGAAAGATTGGAAACAGCAGTCATAATGGCAGTGCACATTCACAATTTTAAAAGAAAAGGGGGGATTGGGGGGTACTCTGCAGCAGAAAGACTAATCAATCGGGTCTATTACAGGGAAGTGTGGAAAGGTCCGGCTAAGCTCATCTGGAAAGGAGAAGGAGCAGTAGTTATA
		</sequence>
		<sequence>
			<taxon idref="SIVagm_tan"/>
			GAAGTCATAGCTAGGGAAACAGGAAAAGAAACAGCAAAATTCCTGTTAAAAATCATTAGTAGGTGGCCTATTACAAAATTACATACTGACAATGGGCCAAATTTTGTTAGTCAGGAGGTACAAACTATTTGTTGGTGGGGACAAGTAGAGCACACAACAGGGATCCCCTATAACCCACAATCACAAGGAAGTGTAGAAAGTATGAATAGACAATTAAAAGAAACTATAGAAAAAATTAGAGAAGACTGTGCATTTTTGGAAACGGCAGTCCTCATGGCCTGCCACATTCACAATTTTAAAAGAAAGGGAGGAATAGGGGGTATGACCCCAGCAGAGAGGCTAATAAACAAGGTCTACTACAGAGAAGTGTGGAAAGGACCAGCCACTCTCCTCTGGAAGGGAGAAGGAGCGGTAGTCATA
		</sequence>
		<sequence>
			<taxon idref="HIV2_BEN"/>
			GAAGTCATCCCACAGGAATCAGGAAGGCAGACAGCACTCTTCCTATTAAAACTGGCCAGTAGGTGGCCAATAACGCACTTGCACACAGACAATGGCCCCAACTTCACTTCACAGGAAGTGAAGATGGTGGCATGGTGGGTAGGTATAGAACAATCCTTTGGAGTACCTTACAACCCACAAAGCCAGGGAGTAGTAGAAGCAATGAATCACCACCTAAAGAATCAGATAAGTAGAATTAGAGAACAGGCAAATACAATAGAAACAATAGTACTGATGGCAGTTCATTGCATGAATTTTAAAAGAAGGGGAGGAATAGGGGATATGACCCCAGCAGAAAGACTAATCAACCAGGTCTATTACAGAGAACTGTGGAAAGGACCTGGTGAACTACTGTGGAAGGGAGAAGGAGCAGTCATAGTC
		</sequence>
		<sequence>
			<taxon idref="SIVsmm"/>
			GAAGTAATCCCGCAGGAAACAGGAAGACAAACAGCACTGTTTCTGTTAAAGTTAGCTGGCAGATGGCCCATCACACATCTGCATACTGATAATGGTGCCAATTTCACATCACAAGAAGTGAAAATGGTTGCCTGGTGGGCAGGGATTGAACAGACCTTTGGGGTGCCTTATAATCCACAGAGCCAAGGAGTAGTGGAAGCAATGAACCATCATTTAAAAACCCAGATAGATAGAATTAGAGAACAAGCAAACTCAATAGAGACTATAGTACTAATGGCAGTTCATTGTATGAATTTTAAAAGAAGGGGAGGAATAGGGGATATGACTCCAGCAGAAAGATTAGTCAATCGGGTCTATTACAGAGAACTGTGGAAAGGACCCGGTGAGCTATTGTGGAAAGGGGAAGGAGCAGTCATCCTA
		</sequence>
		<sequence>
			<taxon idref="SIVmon"/>
			AAAATTTTGCCAGCGGAGACAGGCAAAGAAACAGCACTATTTTTACTGCAGATAGCTGCTAGATGGCCAATCACCAAATTACACACAGACAATGGACCAAATTTTATCAGTCAAGCCATGCAGGCAGCATGTTGGTGGGCAAATATCAAACACACCACAGGAGTTCCATATAATCCACAAAGTCAGGGTATTGTAGAAAATAAGAACAAGCAATTAAAGGAAGTTATAGCACTAGTAAGGGAAGATGCAGAAAGATTAGAAACAGCACTAGCAATGGCAACCCTCATTCTTAATTTTAAAAGAAGGGGAGGACTAGGGGATATGACAGCAGCAGAAAGATACATTAACAAGGTCTATTACAGAGAGCAATGGCAAGGACCAGCTGAGCTGCTTTGGAAAGGTGAAGGAGCAGTTGTCATC
		</sequence>
		<sequence>
			<taxon idref="SIVcpz"/>
			GAAGTTATCCCAGCTGAGACAGGACAAGAAACAGCTTATTTCCTGTTAAAATTAGCAGGTAGATGGCCAGTAAAAACTATTCACACAGATAATGGGCCAAATTTTACAAGTGCTGCAGTCAAGGCTGCCTGTTGGTGGGCAGACATCAAGCAGGAATTTGGAATACCCTATAATCCACAGAGTCAAGGAGTGGTAGAATCCTTAAATAAAGAGCTAAAGAAAATAATAGGACAGGTTAGGGATCAAGCAGAACATTTAAAAACAGCAGTACAAATGGCAGTGTTCATTCACAATTTTAAAAGAAAAGGGGGGATTGGGGGGTACACTGCAGGGGAAAGAATAATAGACCGGGTTTATTACAGAGACATTTGGAAAGGACCGGCAACCTTACTGTGGAAAGGTGAAGGGGCAGTAGTGATC
		</sequence>
		<sequence>
			<taxon idref="SIVgsn"/>
			AGGATAATACCCCAGGAAACAGGCAGACAAACTGCATTGAAGCTCTTAGAATTAGCAGCAACATGGCCTGTAACCCACCTACATACAGATAATGGCCCCAATTTCGTCTCCAAGGAATTGGAAGCAGCCTGCTGGTGGGCAGACATACAACACACCACAGGGGTGCCATACAACCCGCAAAGTCAAGGGGTAGTAGAAAACATGAACAAACAACTCAAGGAAACAATCACGAAAATCAGAGAAGAGGTCACATACTTAGAAACAGCAGTAGCACAGGCATGCTACATTCATAATTTTAAAAGAAAGGGAGGAATAGGGGATATGTGCCCTACAGAAAGAATAGTAAATCGGGTTTATTACAGGCAACTTTGGCAAGGACCAGCAGTACTCCTCTGGAAAGGTGAAGGAGCAGTAGTAGTC
		</sequence>
		<sequence>
			<taxon idref="SIVlhoest"/>
			GAAGTGATTCCAGATGAAACAGGGAAAACTACAGCAAATTTTTTGTTAAAGTTATGTAGCAGATGGCCTGTAAAACAAATTCACACAGATAATGGTCCAAATTTTGTGAGTAAAGATGTACAGGCAGTGACCTGGTGGTTAAGTATAGAGCACACAACAGGGATACCATATAACCCTCAAAGTCAAGGAGTAGTAGAGGCAAAAAATAAAGTTTTAAAGCAAATCATAGAAAGAGTAAGAGAAGATGCACAGCAGCTAAAGACAGCAGTGTTAATGGCAGTCCACATTCATAATTTTAAACAAAGGGGAGGACTGGGGGGGTTATCACCAGCAGAGAGATACATCAATAAGGTTTACTACAGACAACAGTGGAGAGGACCTGCTCAACTTCTGTGGAAAGGAGAAGGTGCTGTAGTGGTA
		</sequence>
		<sequence>
			<taxon idref="SIVsun"/>
			GAAGTACTACCCAATGAGCAAGGGAAGACAACAGCCACTTGGCTGTTAAAGCTCTGTGCCATGTGGCCAGTAAAACAGATACATACAGATAATGGGCCAAATTTCATCAGTAAAGATGTGGAGGCAGTATGTTGGTGGTTAGGCATACAGCATACAACAGGGATACCTTACAACCCTCAGAGTCAAGGAGTAGTGGAAGCAAAGAACAAGGTATTAAAACAAATTATCAGCAGAATTAGAGAAGATGCACAGGAATTGAAAACTGCAGTACTCATGGCTCTGCACATTCATAATTTTAAACAAAGGGGAGGACTAGGGGGAATGACAGCAGCAGAGAGGTTTATCAACAAGGTCTACTACAGAGAACAGTGGAAAGGACCTGCTAAACTTCTGTGGAAAGGGGAAGGAGCAGTAGTCATC
		</sequence>
		<sequence>
			<taxon idref="SIVdrl"/>
			GAAGTAATACCAGCAGAAACAGGAGAGAAAACAGCTTATTTTCTGCTAAAATTAGCTGGCAGATGGCCAGTATCACACTTGCACACAGATAATGGACCAAATTTCACCAGTGAAAAGGTAGCAACAGTATGCTGGTGGGCTAAGATAGAGCATACCACAGGAGTTCCCTATAACCCCCAGAGTCAAGGAGTGGTAGAATCAATGAACAATCAGCTAAAGAAAATTATAGGACAAATTAGAGATCAGGCAGAAAAACTAGAGACAGCAGTTCAAATGGCAGTACTGATTCACAATTTTAAAAGAAAAGGGGGGATAGGGGAGTACAGTGCAGCAGAAAGAATAGTAGACCGGGTTTATTACAGAGAGTTGTGGAAAGGACCAGCAGAACTTGTCTGGAAAGGGGAAGGAGCGGTGGTCATC
		</sequence>
		<sequence>
			<taxon idref="SIVdrl_DRL38_Bioko"/>
			GAAGTAATACCAGCAGAAACAGGAGAAAAGACAGCATACTTCCTGTTAAAACTGGCTGGAAGATGGCCAGTGAAACATCTACACACTGACAATGGTCCAAACTTTGTCAGTGAGAAGGTAGCATCTATCTGTTGGTGGGCTCAAATAGAGCACACAACAGGAGTACCCTACAACCCACAAAGCCAAGGGGTTGTGGAGTCCATGAACAATCAGTTAAAGATAATCATCAATCAGATTAGAGATCAGGCAGAGAAACTAGAAACAGCAGTTCAAATGGCAGTTCTAATCCACAATTTTAAAAGAAAAGGGGGGATAGGGGAGTACAGTGCAGCAGAAAGAATAGTGGATCGGGTTTATTACAGAGAACAGTGGAAAGGTCCGGCTGAACTCATTTGG------------------------
		</sequence>
		<sequence>
			<taxon idref="SIVmnd"/>
			GAAGTTATAACAGCAGAAACTGGAAAAAAGACAGCAGAGTTTCTGTTAAAGTTAGCAGCACAATGGCCTATTAGTAAACTACACACAGATAATGGGCCTAACTTTACTAGTCAGGAAGTAGAAACCATGTGTTGGTGGTTAGGGATAGAACACACATTTGGAATACCCTATAACCCACAAAGTCAGGGGGTAGTGGAAAATAAAAATAAGTATCTAAAAGAATTGATTGAGAAAATAAGAGAAGATTGCAAAGAATTAAAAACAGCAGTAGCCATGGCCACATTCATTCATAATTTTAAACAAAGGGGAGGACTAGGGGGGATGACAGCAGGAGAGAGAATAGTAAATAAGGTTTACTTCAGAGAACTGTGGAAAGGACCTGGTATCCTTTTGTGGAAAGGAGAAGGGGCAGTAGTTTTA
		</sequence>
		<sequence>
			<taxon idref="SIVmnd5440"/>
			GAGGTAATACCAGCAGAGACAGGAAAAGAAACAGCGCACTTCCTGTTAAAGCTAGCAGGTAGGTGGCCAGTAAAACATCTACACACTGACAATGGTCCTAACTTTGTCAGTGAAAAGGTGGCCACAGTCTGCTGGTGGGCTCAAATAGAGCACACCACAGGAGTACCTTACAACCCACAGAGTCAAGGAGTAGTAGAAGCAAAAAATCATCATCTTAAGAAGATCATAGAACAAGTTAGGGATCAAGCTGAAAGGCTAGAAACAGCAGTGCAAATGGCAGTGCTAATTCACAATTTTAAAAGAAAAGGGGGGATAGGGGAGTACAGTCCTGGAGAAAGAATAGTAGACCAGGTTTATTACAGAGAACAGTGGAAAGGACCAGCAGAGCTCATTTGGAAAGGAGAAGGCGCTGTGGTAATC
		</sequence>
		<sequence>
			<taxon idref="SIVcpz_tan3"/>
			GAGGTCATACCAGAAGAAACAGGAAAGGAAACAGCTTATTTCATCCTAAAACTGGCAGGAAGATGGCCAGTAAAGAAAATACATACAGACAATGGGCCAAATTTTACTAGTGCAGCAGTAAAAGCAGCCTGTTGGTGGGCGCAAATTCAACATGAGTTTGGGATTCCATATAATCCTCAAAGTCAAGGAGTAGTAGAATCCATGAATAAACAATTAAAGCAAATCATAGGACAAATTAGGGAACAAGCAGAGCACTTGAGGACAGCAGTAACTATGGCAGTGTATATCCACAATTTTAAAAGAAAAGGGGGGATTGGGGAGTACACTGCAGGGGAAAGACTATTGGACCGGGTTTATTATAGGGACATTTGGAAGGGACCAGCGCGGCTGCTGTGGAAAGGTGAAGGGGCAGTAGTAATA
		</sequence>
		<sequence>
			<taxon idref="SIVrcm"/>
			GAAGTCATACCAGCAGAAACAGGAAAAGAGACAGCTTACTTCCTGTTAAAACTAGCAGCAAGATGGCCAGTGAAACATTTGCACACAGACAATGGAGCAAATTTTACAAGTGCAGCAGTACAAGCAGTCTGTTGGTGGGCTCAAATAGAGCACACCTTTGGGGTACCCTACAATCCTCAAAGCCGAGGAGTGGTAGAATCAATGAATCACCAATTGAAAACAATTATAGGCCAGATTAGAGACCAAGCAGAAAAATTAGAGACAGCAGTACAAATGGCAGTGCTTGTCCACAATTTTAAAAGAAAAGGGGGGATTGGGGGGTACAGTGCAGGAGAAAGAATAATAGACCGGGTCTATTACAGAGAACAGTGGAAGGGACCGGCTAAACTCATCTGGAAAGGAGAAGGGGCTGTGGTGATC
		</sequence>
		<sequence>
			<taxon idref="HIV_1_hxb2"/>
			GAAGTTATTCCAGCAGAAACAGGGCAGGAAACAGCATATTTTCTTTTAAAATTAGCAGGAAGATGGCCAGTAAAAACAATACATACTGACAATGGCAGCAATTTCACCGGTGCTACGGTTAGGGCCGCCTGTTGGTGGGCGGGAATCAAGCAGGAATTTGGAATTCCCTACAATCCCCAAAGTCAAGGAGTAGTAGAATCTATGAATAAAGAATTAAAGAAAATTATAGGACAGGTAAGAGATCAGGCTGAACATCTTAAGACAGCAGTACAAATGGCAGTATTCATCCACAATTTTAAAAGAAAAGGGGGGATTGGGGGGTACAGTGCAGGGGAAAGAATAGTAGACCGGGTTTATTACAGGGACCTTTGGAAAGGACCAGCAAAGCTCCTCTGGAAAGGTGAAGGGGCAGTAGTAATA
		</sequence>
		<sequence>
			<taxon idref="A1_KE_AF457053_2000"/>
			GAAGTTATCCCAGCAGAAACAGGACAAGAGACAGCATACTTTTTACTGAAATTAGCAGGAAGATGGCCAGTAAAAGTAGTACACACAGACAATGGCAGCAATTTCACCAGCGCTGCAGTTAAAGCAGCCTGTTGGTGGGCAGGTATCCAACAGGAATTTGGAATTCCCTACAATCCCCAAAGTCAAGGAGTAGTGGAATCTATGAATAAGGAATTAAAGAAAATCATAGGACAGGTAAGAGAACAAGCTGAACACCTTAAAACAGCGGTACAAATGGCAGTATTCATTCACAATTTTAAAAGAAAAGGGGGGATTGGGGGGTACAGTGCAGGGGAAAGAATAATAGACCGGGTTTATTTCAGGGACCTTTGGAAAGGACCAGCAAAACTACTCTGGAAAGGTGAAGGGGCAGTAGTAATA
		</sequence>
		<sequence>
			<taxon idref="A2_CD_AF286238_1997"/>
			GAAGTCATCCCAGCAGAGACAGGACAGGAGACAGCATACTTTCTATTAAAATTAGCAGGAAGATGGCCAGTAAAAGTAATACATACAGACAATGGGCCCAATTTCACCAGTGCAGCAGTTAAGGCAGCCTGTTGGTGGGCAGATGTCAAACAGGAATTTGGGATTCCCTACAATCCCCAAAGTCAAGGAGTAGTGGAATCTATGAATAAAGAATTAAAGAAAATCATAGGGCAGGTAAGAGATCAAGCTGAACATCTTAAGACAGCAGTGCAAATGGCAGTGTTCATCCACAATTTTAAAAGAAAAGGGGGGATTGGGGGATACAGTGCAGGGGAAAGAATAATAGACCGGGTTTATTACAGGGACATTTGGAAAGGACCAGCAAAACTCCTTTGGAAAGGTGAAGGGGCAGTAGTAATA
		</sequence>
		<sequence>
			<taxon idref="A3_SN_AY521631_2001"/>
			GAAGTTATCCCAGCAGAAACAGGACAGGAAACAGCATACTTCCTGTTAAAATTAGCAGGAAGATGGCCAGTAAAAGTAATACACACAGACAATGGCAGCAACTTCACCAGTGCTGCAGTGAAAGCAGCCTGTTGGTGGGCAAATATCCAACAGGAATTTGGAATTCCCTACAATCCCCAAAGTCAAGGAGTAGTGGAATCTATGAATAAGGAATTAAAGAAAATCATAGGGCAGGTAAGAGAGCAAGCTGAACACCTTAAGACAGCAGTACAAATGGCAGTATTCATTCACAATTTTAAAAGAAAAGGGGGGATTGGGGGGTACAGTGCAGGGGAAAGAATAATAGACCGGGTTTATTACAGGGACATTTGGAAAGGACCAGCAAAACTACTCTGGAAAGGTGAAGGGGCAGTAGTAATA
		</sequence>
		<sequence>
			<taxon idref="A6_RU_EF545108_2000"/>
			GAAGTTATCCCAGCAGAAACAGGACAGGAGACAGCATACTTTCTGCTAAAATTAGCAGGAAGGTGGCCAGTAAAAGTAATACACACAGATAATGGCAGCAATTTCACCAGCAGTGCAGTTAAAGCTGCCTGTTGGTGGGCAAATATCCAACAGGAATTTGGGATTCCCTACAATCCCCAAAGCCAAGGAGTGGTGGAATCTATGAATAAGGAATTAAAGAAAATCATAGGGCAGGTAAGAGAGCAAGCTGAACACCTTAAGACAGCAGTACAAATGGCAGTATTCATTCACAATTTTAAAAGAAAAGGGGGGATTGGGGGGTACAGTGCAGGGGAAAGAATAATAGACCGGGTTTATTACAGAGACGTTTGGAAAGGACCAGCAAAACTACTCTGGAAAGGTGAAGGGGCAGTGGTAATA
		</sequence>
		<sequence>
			<taxon idref="B_US_FJ469707_2007"/>
			GAAGTTATTCCAGCAGAGACAGGGCAGGAAACAGCATACTTTCTTTTAAAATTAGCAGGAAGATGGCCAGTAAAAACAATACATACAGACAATGGCAGCAATTTCACCAGTACTACAGTTAAAGCCGCCTGTTGGTGGGCAGGGATCAAGCAGGAATTTGGCATTCCCTACAATCCCCAAAGTCAAGGAGTAGTAGAATCTATGAATAAAGAATTAAAGAAAATTATAGGACAGGTAAGAGATCAGGCTGAACATCTTAAGACAGCTGTACAAATGGCAGTATTCATTCACAATTTTAAAAGAAAAGGGGGGATTGGGGGGTACAGTGCAGGGGAAAGAATAGTAGACCGGGTTTATTACAGGGACCTTTGGAAAGGACCAGCAAAGCTTCTCTGGAAAGGTGAAGGGGCAGTAGTAATA
		</sequence>
		<sequence>
			<taxon idref="C_ZA_AY878064_2003"/>
			GAAGTTATCCCAGCAGAAACAGGACAGGAAACAGCATACTATATATTAAAGCTAGCAGGAAGATGGCCAGTAAAAGTAATACATACAGACAATGGCCCCAATTTCACCAGTGCTGCAGTCAAGGCAGCCTGTTGGTGGGCAGGTATCCAACAAGAATTTGGGATCCCCTACAATCCCCAAAGTCAGGGAGTAGTAGAATCCATGAATAAAGAACTAAAGAAAATCATAGGGCAGGTAAGAGATCAAGCTGAGCACCTTAAGACAGCAGTACAAATGGCAGTATTCATTCACAATTTTAAAGGAAAAGGGGGGATTGGGGGGTACAGTGCAGGGGAAAGAATAATAGACCGGGTTTATTACAGAGACATTTGGAAAGGACCAGCCAAACTACTCTGGAAAGGTGAAGGGGCAGTAGTAATA
		</sequence>
		<sequence>
			<taxon idref="D_UG_JX236679_2007"/>
			GAAGTTATTCCAGCAGAAACAGGGCAGGAAACAGCATACTTTCTCTTGAAATTAGCAGGAAGATGGCCAGTAAAAGTAGTACATACAGATAATGGCAGCAATTTCACCAGCAATGCAGTAAAGGCCGCCTGTTGGTGGGCAGGCATCAAGCAGGAATTTGGAATTCCCTACAATCCCCAAAGTCAAGGAGTAGTAGAATCCATGAACAAAGAATTAAAGAAAATTATTGGACAAGTAAGAGATCAAGCTGAACATCTTAAGACAGCAGTACAAATGGCAGTATTTGTCCACAATTTTAAAAGAAAAGGGGGGATTGGGGGGTACAGTGCAGGGGAAAGAATAATAGACCGGGTTTATTACAGGGACATTTGGAAAGGACCAGCAAAGCTTCTTTGGAAAGGTGAAGGGGCAGTAGTAATA
		</sequence>
		<sequence>
			<taxon idref="F1_BR_AB485657_1990"/>
			GAAGTTATCCCAACAGAAACAGGACAAGAAACAGCCTACTTCATACTAAAGTTAGCAGGAAGATGGCCAGTAAAAACAATACATACAGACAATGGCACCAATTTCACCAGTGCCGCGGTTAAGGCAGCCTGTTGGTGGGCAGGTATCCAGCAGGAATTTGGAATTCCCTACAATCCCCAAAGTCAAGGAGTAGTAGAATCTATGAATAAAGAGCTAAAGAAGATTATAAAACAGGTAAGAGATCAAGCTGAACATCTTAAGACAGCAGTACAAATGGCAGTATTCATCCACAATTTTAAAAGAAAAGGGGGGATTGGGGGATACAGTGCAGGGGAAAGAATAATAGACCGGGTTTATTACAGGGACGTTTGGAAAGGACCAGCAAAGCTACTCTGGAAAGGTGAAGGGGCAGTAGTCATA
		</sequence>
		<sequence>
			<taxon idref="F2_CM_AY371158_2002"/>
			GAAGTTATTCCAGCAGAAACGGGACAGGAAACAGCCTATTTCATATTAAAGTTAGCAGGAAGATGGCCAGTAAAAATAATACATACAGACAATGGCAGCAATTTCACCAGTACTGTGGTTAAGGCAGCCTGTTGGTGGGCAGGTATCCAACAGGAATTTGGAATTCCCTACAATCCCCAAAGTCAAGGAGTAGTAGAATCTATGAATAAAGAATTAAAGAAAATTATAGGACAAGTAAGAGATCAAGCTGAACATCTTAAGACAGCAGTGCAAATGGCAGTATTCATTCACAATTTTAAAAGAAAAGGGGGGATTGGGGGGTACAGTGCAGGGGAAAGAATAATAGACCGGGTTTATTTCAGAGACATTTGGAAAGGACCAGCAAAGCTACTCTGGAAAGGTGAAGGGGCAGTAGTCATA
		</sequence>
	</alignment>

	<!-- The unique patterns for codon position 1                                -->

	<!-- The unique patterns from 1 to end every 3                               -->
	<!-- npatterns=118                                                           -->
	<patterns id="CP1.patterns" from="1" every="3" strip="false">
		<alignment idref="alignment"/>
	</patterns>

	<!-- The unique patterns for codon position 2                                -->

	<!-- The unique patterns from 2 to end every 3                               -->
	<!-- npatterns=108                                                           -->
	<patterns id="CP2.patterns" from="2" every="3" strip="false">
		<alignment idref="alignment"/>
	</patterns>

	<!-- The unique patterns for codon position 3                                -->

	<!-- The unique patterns from 3 to end every 3                               -->
	<!-- npatterns=140                                                           -->
	<patterns id="CP3.patterns" from="3" every="3" strip="false">
		<alignment idref="alignment"/>
	</patterns>

	<!-- A prior assumption that the population size has remained constant       -->
	<!-- throughout the time spanned by the genealogy.                           -->
	<constantSize id="constant" units="years">
		<populationSize>
			<parameter id="constant.popSize" value="1.0" lower="0.0"/>
		</populationSize>
	</constantSize>
	
	<!-- Generate a random starting tree under the coalescent process            -->
	<coalescentSimulator id="startingTree"> <!-- selected by checking mono in taxa -->
		<coalescentSimulator>
			<taxa idref="HIVM"/>
			<constantSize idref="constant"/>
		</coalescentSimulator>
		<coalescentSimulator>
			<taxa idref="drill"/>
			<constantSize idref="constant"/>
		</coalescentSimulator>
		<taxa idref="taxa"/>
		<constantSize idref="constant"/>
	</coalescentSimulator>

	<!-- Generate a tree model                                                   -->
	<treeModel id="treeModel">
		<coalescentTree idref="startingTree"/>
		<rootHeight>
			<parameter id="treeModel.rootHeight"/>
		</rootHeight>
		<nodeHeights internalNodes="true">
			<parameter id="treeModel.internalNodeHeights"/>
		</nodeHeights>
		<nodeHeights internalNodes="true" rootNode="true">
			<parameter id="treeModel.allInternalNodeHeights"/>
		</nodeHeights>
	</treeModel>

	<!-- Taxon Sets                                                              -->
	<tmrcaStatistic id="tmrca(HIVM)" includeStem="false">
		<mrca>
			<taxa idref="HIVM"/>
		</mrca>
		<treeModel idref="treeModel"/>
	</tmrcaStatistic>
	<monophylyStatistic id="monophyly(HIVM)">
		<mrca>
			<taxa idref="HIVM"/>
		</mrca>
		<treeModel idref="treeModel"/>
	</monophylyStatistic>
	<tmrcaStatistic id="tmrca(drill)" includeStem="false">
		<mrca>
			<taxa idref="drill"/>
		</mrca>
		<treeModel idref="treeModel"/>
	</tmrcaStatistic>
	<monophylyStatistic id="monophyly(drill)">
		<mrca>
			<taxa idref="drill"/>
		</mrca>
		<treeModel idref="treeModel"/>
	</monophylyStatistic>

	<!-- Generate a coalescent likelihood                                        -->
	<coalescentLikelihood id="coalescent">
		<model>
			<constantSize idref="constant"/>
		</model>
		<populationTree>
			<treeModel idref="treeModel"/>
		</populationTree>
	</coalescentLikelihood>

	<!-- The HKY substitution model (Hasegawa, Kishino & Yano, 1985)             -->
	<HKYModel id="CP1.hky">
		<frequencies>
			<frequencyModel dataType="nucleotide">
				<frequencies>
					<parameter id="CP1.frequencies" value="0.25 0.25 0.25 0.25"/>
				</frequencies>
			</frequencyModel>
		</frequencies>
		<kappa>
			<parameter id="CP1.kappa" value="2.0" lower="0.0"/>
		</kappa>
	</HKYModel>

	<!-- The HKY substitution model (Hasegawa, Kishino & Yano, 1985)             -->
	<HKYModel id="CP2.hky">
		<frequencies>
			<frequencyModel dataType="nucleotide">
				<frequencies>
					<parameter id="CP2.frequencies" value="0.25 0.25 0.25 0.25"/>
				</frequencies>
			</frequencyModel>
		</frequencies>
		<kappa>
			<parameter id="CP2.kappa" value="2.0" lower="0.0"/>
		</kappa>
	</HKYModel>

	<!-- The HKY substitution model (Hasegawa, Kishino & Yano, 1985)             -->
	<HKYModel id="CP3.hky">
		<frequencies>
			<frequencyModel dataType="nucleotide">
				<frequencies>
					<parameter id="CP3.frequencies" value="0.25 0.25 0.25 0.25"/>
				</frequencies>
			</frequencyModel>
		</frequencies>
		<kappa>
			<parameter id="CP3.kappa" value="2.0" lower="0.0"/>
		</kappa>
	</HKYModel>

	<!-- site model                                                              -->
	<siteModel id="CP1.siteModel">
		<substitutionModel>
			<HKYModel idref="CP1.hky"/>
		</substitutionModel>
		<relativeRate>
			<parameter id="CP1.mu" value="1.0" lower="0.0"/>
		</relativeRate>
		<gammaShape gammaCategories="4">
			<parameter id="CP1.alpha" value="0.5" lower="0.0"/>
		</gammaShape>
	</siteModel>

	<!-- site model                                                              -->
	<siteModel id="CP2.siteModel">
		<substitutionModel>
			<HKYModel idref="CP2.hky"/>
		</substitutionModel>
		<relativeRate>
			<parameter id="CP2.mu" value="1.0" lower="0.0"/>
		</relativeRate>
		<gammaShape gammaCategories="4">
			<parameter id="CP2.alpha" value="0.5" lower="0.0"/>
		</gammaShape>
	</siteModel>

	<!-- site model                                                              -->
	<siteModel id="CP3.siteModel">
		<substitutionModel>
			<HKYModel idref="CP3.hky"/>
		</substitutionModel>
		<relativeRate>
			<parameter id="CP3.mu" value="1.0" lower="0.0"/>
		</relativeRate>
		<gammaShape gammaCategories="4">
			<parameter id="CP3.alpha" value="0.5" lower="0.0"/>
		</gammaShape>
	</siteModel>

	<!-- Collecting together relative rates for partitions                       -->
	<compoundParameter id="allMus">
		<parameter idref="CP1.mu"/>
		<parameter idref="CP2.mu"/>
		<parameter idref="CP3.mu"/>
	</compoundParameter>

    <designMatrix id="epochDesignMatrix">
        <parameter id="designMatrix.offset" value="1 1 1 1 1 1 1 1 1"/> 
        <parameter id="designMatrix.time"   value="-12.20607265 -9.808177373 -7.50559228 -5.203007187 -2.900422094 -0.597837001 1.704748092 4.007333185 6.309918278"/>
    </designMatrix>

	<matrixVectorProductParameter id="all.rates">
		<matrix>
			<designMatrix idref="epochDesignMatrix"/>
		</matrix>
		<vector>
			<compoundParameter>
				<parameter id="epochIntercept" value="0"/>
				<parameter id="epochCoefficient" value="-0.5"/>
			</compoundParameter>
	    </vector>
	</matrixVectorProductParameter>

	<transformedParameter id="epoch.rate01" inverse="true">
		<transform type="log"/>
		<maskedParameter signalDependents="false"> <!-- determininistic function of coefficients -->
			<parameter idref="all.rates"/>
			<mask>
				<parameter value="1 0 0 0 0 0 0 0 0"/>  
			</mask>
		</maskedParameter>
	</transformedParameter>

	<transformedParameter id="epoch.rate02" inverse="true">
		<transform type="log"/>
		<maskedParameter signalDependents="false"> <!-- determininistic function of coefficients -->
			<parameter idref="all.rates"/>
			<mask>
				<parameter value="0 1 0 0 0 0 0 0 0"/>  
			</mask>
		</maskedParameter>
	</transformedParameter>

	<transformedParameter id="epoch.rate03" inverse="true">
		<transform type="log"/>
		<maskedParameter signalDependents="false"> <!-- determininistic function of coefficients -->
			<parameter idref="all.rates"/>
			<mask>
				<parameter value="0 0 1 0 0 0 0 0 0"/>  
			</mask>
		</maskedParameter>
	</transformedParameter>

	<transformedParameter id="epoch.rate04" inverse="true">
		<transform type="log"/>
		<maskedParameter signalDependents="false"> <!-- determininistic function of coefficients -->
			<parameter idref="all.rates"/>
			<mask>
				<parameter value="0 0 0 1 0 0 0 0 0"/>  
			</mask>
		</maskedParameter>
	</transformedParameter>

	<transformedParameter id="epoch.rate05" inverse="true">
		<transform type="log"/>
		<maskedParameter signalDependents="false"> <!-- determininistic function of coefficients -->
			<parameter idref="all.rates"/>
			<mask>
				<parameter value="0 0 0 0 1 0 0 0 0"/>  
			</mask>
		</maskedParameter>
	</transformedParameter>

	<transformedParameter id="epoch.rate06" inverse="true">
		<transform type="log"/>
		<maskedParameter signalDependents="false"> <!-- determininistic function of coefficients -->
			<parameter idref="all.rates"/>
			<mask>
				<parameter value="0 0 0 0 0 1 0 0 0"/>  
			</mask>
		</maskedParameter>
	</transformedParameter>

	<transformedParameter id="epoch.rate07" inverse="true">
		<transform type="log"/>
		<maskedParameter signalDependents="false"> <!-- determininistic function of coefficients -->
			<parameter idref="all.rates"/>
			<mask>
				<parameter value="0 0 0 0 0 0 1 0 0"/>  
			</mask>
		</maskedParameter>
	</transformedParameter>

	<transformedParameter id="epoch.rate08" inverse="true">
		<transform type="log"/>
		<maskedParameter signalDependents="false"> <!-- determininistic function of coefficients -->
			<parameter idref="all.rates"/>
			<mask>
				<parameter value="0 0 0 0 0 0 0 1 0"/>  
			</mask>
		</maskedParameter>
	</transformedParameter>

	<transformedParameter id="epoch.rate09" inverse="true">
		<transform type="log"/>
		<maskedParameter signalDependents="false"> <!-- determininistic function of coefficients -->
			<parameter idref="all.rates"/>
			<mask>
				<parameter value="0 0 0 0 0 0 0 0 1"/>  
			</mask>
		</maskedParameter>
	</transformedParameter>

	<rateEpochBranchRates id="epochRates" continuousNormalization="false">
		<epoch transitionTime="0.00001">
			<parameter idref="epoch.rate01"/>
		</epoch>
		<epoch transitionTime="0.0001">
			<parameter idref="epoch.rate02"/>
		</epoch>
		<epoch transitionTime="0.001">
			<parameter idref="epoch.rate03"/>
		</epoch>
		<epoch transitionTime="0.01">
			<parameter idref="epoch.rate04"/>
		</epoch>
		<epoch transitionTime="0.1">
			<parameter idref="epoch.rate05"/>
		</epoch>
		<epoch transitionTime="1">
			<parameter idref="epoch.rate06"/>
		</epoch>
		<epoch transitionTime="10">
			<parameter idref="epoch.rate07"/>
		</epoch>
		<epoch transitionTime="100">
			<parameter idref="epoch.rate08"/>
		</epoch>
		<rate>
			<parameter idref="epoch.rate09"/>
		</rate>
		<rootHeight>
			<parameter idref="treeModel.rootHeight"/>
		</rootHeight>
	</rateEpochBranchRates>

	<compoundParameter id="epoch.rates">
		<parameter idref="epoch.rate01"/>
		<parameter idref="epoch.rate02"/>
		<parameter idref="epoch.rate03"/>
		<parameter idref="epoch.rate04"/>
		<parameter idref="epoch.rate05"/>
		<parameter idref="epoch.rate06"/>
		<parameter idref="epoch.rate07"/>
		<parameter idref="epoch.rate08"/>
		<parameter idref="epoch.rate09"/>
	</compoundParameter>

	<logarithmStatistic id="logRates">
		<parameter idref="epoch.rates"/>
	</logarithmStatistic>

 	<compoundParameter id="fixedEffects">
		<parameter id="fixedTo1" value="1.0"/>
	</compoundParameter>

	<fixedEffects id="fixedEffectsModel" includeIntercept="false" timeEffect="false">
		<treeModel idref="treeModel"/>
		<compoundParameter idref="fixedEffects"/>
		<rateEpochBranchRates idref="epochRates"/>
		<signTransform/>
	</fixedEffects>

   <arbitraryBranchRates id="branchRates" reciprocal="false" exp="false" centerAtOne="false">
        <rates>
            <parameter id="clock.rates" value="0.2" lower="0"/>
        </rates>
        <scale>
            <parameter id="clock.rates.scale" lower="0.0" value="0.22"/>
        </scale>
        <location>
        	<fixedEffects idref="fixedEffectsModel"/>
        </location>
        <treeModel idref="treeModel"/>
    </arbitraryBranchRates>
	
	<!-- Likelihood for tree given sequence data                                 -->
	<treeDataLikelihood id="CP1.treeLikelihood" useAmbiguities="false" usePreOrder="true" scalingScheme="always" delayScaling="false">
		<patterns idref="CP1.patterns"/>
		<siteModel idref="CP1.siteModel"/>
		<treeModel idref="treeModel"/>
		<arbitraryBranchRates idref="branchRates"/>
	</treeDataLikelihood>

	<!-- Likelihood for tree given sequence data                                 -->
	<treeDataLikelihood id="CP2.treeLikelihood" useAmbiguities="false" usePreOrder="true" scalingScheme="always" delayScaling="false">
		<patterns idref="CP2.patterns"/>
		<siteModel idref="CP2.siteModel"/>
		<treeModel idref="treeModel"/>
		<arbitraryBranchRates idref="branchRates"/>
	</treeDataLikelihood>

	<!-- Likelihood for tree given sequence data                                 -->
	<treeDataLikelihood id="CP3.treeLikelihood" useAmbiguities="false" usePreOrder="true" scalingScheme="always" delayScaling="false">
		<patterns idref="CP3.patterns"/>
		<siteModel idref="CP3.siteModel"/>
		<treeModel idref="treeModel"/>
		<arbitraryBranchRates idref="branchRates"/>
	</treeDataLikelihood>

	<compoundLikelihood id="treeLikelihood">
		<treeDataLikelihood idref="CP1.treeLikelihood"/>
		<treeDataLikelihood idref="CP2.treeLikelihood"/>
		<treeDataLikelihood idref="CP3.treeLikelihood"/>
	</compoundLikelihood>
	
	<distributionLikelihood id="epochCoefficientPrior">
		<data>
			<parameter idref="fixedTo1"/>
		</data>
		<distribution>
			<normalDistributionModel meanInRealSpace="true">
				<mean>
					<parameter value="0.0"/>
				</mean>
				<stdev>
					<parameter value="100.0" lower="0.0"/>
				</stdev>
			</normalDistributionModel>
		</distribution>
	</distributionLikelihood>

    <distributionLikelihood id="ratesPrior">
        <data>
            <parameter idref="clock.rates"/>
        </data>
        <distribution>
            <logNormalDistributionModel meanInRealSpace="true">
                <mean>
                    <parameter value="1.0" lower="0.0"/>
                </mean>
                <stdev>
                    <parameter value="1.0" lower="0.0"/>
                </stdev>
            </logNormalDistributionModel>
        </distribution>
    </distributionLikelihood>

	<branchRateGradient id="branchRateGradient1" traitName="Sequence" useHessian="true">
		<treeDataLikelihood idref="CP1.treeLikelihood"/>
	</branchRateGradient>

	<branchRateGradient id="branchRateGradient2" traitName="Sequence" useHessian="true">
		<treeDataLikelihood idref="CP2.treeLikelihood"/>
	</branchRateGradient>

	<branchRateGradient id="branchRateGradient3" traitName="Sequence" useHessian="true">
		<treeDataLikelihood idref="CP3.treeLikelihood"/>
	</branchRateGradient>
	
	<jointGradient id="jointGradient">
		<hessian>
			<distributionLikelihood idref="ratesPrior"/>
			<parameter idref="clock.rates"/>
		</hessian>
		<branchRateGradient idref="branchRateGradient1"/>
		<branchRateGradient idref="branchRateGradient2"/>
		<branchRateGradient idref="branchRateGradient3"/>
	</jointGradient>


	<locationScaleGradient id="locationGradient" traitName="Sequence" useHessian="true">
<!-- 		<treeDataLikelihood idref="treeLikelihood"/> -->
		<compoundLikelihood idref="treeLikelihood"/>
		<location>
			<fixedEffects idref="fixedEffectsModel"/>
		</location>
	</locationScaleGradient>

<!-->  TODO Update for fixed fixed-effects coefficents -->
	<jointGradient id="jointLocationGradient">
		<compoundGradient id="locationPriorGradient">
			<hessian>
				<distributionLikelihood idref="epochCoefficientPrior"/>
				<parameter idref="fixedTo1"/>
			</hessian>
		</compoundGradient>
		<locationScaleGradient idref="locationGradient"/>
	</jointGradient>

	<report>
		<jointGradient idref="jointLocationGradient"/>
	</report>

	<locationScaleGradient id="scaleGradient" traitName="Sequence" useHessian="true">
<!-- 		<treeDataLikelihood idref="treeLikelihood"/> -->
		<compoundLikelihood idref="treeLikelihood"/>
		<scale>
			<parameter idref="clock.rates.scale"/>
		</scale>
	</locationScaleGradient>

	<distributionLikelihood id="scalePrior">
		<data>
			<parameter idref="clock.rates.scale"/>
		</data>
		<distribution>
			<exponentialDistributionModel meanInRealSpace="true">
				<mean>
					<parameter value="1.0" lower="0.0"/>
				</mean>
			</exponentialDistributionModel>
		</distribution>
	</distributionLikelihood>

	<jointGradient id="jointScaleGradient">
		<hessian>
			<distributionLikelihood idref="scalePrior"/>
			<parameter idref="clock.rates.scale"/>
		</hessian>
		<locationScaleGradient idref="scaleGradient"/>
	</jointGradient>

	<report>
		<locationScaleGradient idref="scaleGradient"/>
	</report>

	<report>
		<locationScaleGradient idref="locationGradient"/>
	</report>

	<compoundGradient id="locationScaleGradient">
		<locationScaleGradient idref="locationGradient"/>
		<locationScaleGradient idref="scaleGradient"/>
	</compoundGradient>

	<compoundParameter id="locationScale">
		<compoundParameter idref="fixedEffects"/>
		<parameter idref="clock.rates.scale"/>
	</compoundParameter>

	<compoundParameter id="all.rates.related">
		<parameter idref ="clock.rates"/>
		<compoundParameter idref="locationScale"/>
	</compoundParameter>

	<compoundGradient id="all.rates.related.Gradient">
		<jointGradient idref="jointGradient"/>
		<jointGradient idref="locationScaleGradient"/>
	</compoundGradient>

    <maximizeWrtParameter id="maximizeWrtParameter" startAtCurrentState = "true" printToScreen="true" nIterations="10">
<!--
        <compoundGradient idref="all.rates.related.Gradient"/>
		<signTransform>
			<compoundParameter idref="all.rates.related"/>
		</signTransform>
 -->

		<jointGradient idref="jointGradient"/>
		<signTransform>
			<parameter idref="clock.rates"/>
		</signTransform>

    </maximizeWrtParameter>

    <report>
        <maximizeWrtParameterParser idref="maximizeWrtParameter"/>
    </report>

	<report>
		<locationScaleGradient idref="scaleGradient"/>
	</report>

	<report>
		<locationScaleGradient idref="locationGradient"/>
	</report>
	
				<multivariateNormalPrior id="rate.prior.effects">
					<data>
						<compoundParameter>
							<parameter idref="epochIntercept"/> 
							<parameter idref="epochCoefficient"/> 
						</compoundParameter> 
					</data>
					<meanParameter>
						<parameter value="0 0"/>
					</meanParameter>
					<precisionParameter>
						<matrixParameter>
							<parameter value="0.001 0"/>
							<parameter value="0 0.5"/>
						</matrixParameter>
					</precisionParameter>
				</multivariateNormalPrior>

	<!-- Define operators                                                        -->
	<operators id="operators" optimizationSchedule="default">
		<scaleOperator scaleFactor="0.75" weight="10">
			<parameter idref="clock.rates"/>
		</scaleOperator>

 		<randomWalkOperator windowSize="1.0" weight="2">
			<parameter idref="epochIntercept"/>
		</randomWalkOperator> 
		<randomWalkOperator windowSize="1.0" weight="10">
			<parameter idref="epochCoefficient"/>
		</randomWalkOperator>

		<scaleOperator scaleFactor="0.75" weight="2">
			<parameter idref="clock.rates.scale"/>
		</scaleOperator>

		<scaleOperator scaleFactor="0.75" weight="1">
			<parameter idref="CP1.kappa"/>
		</scaleOperator>
		<scaleOperator scaleFactor="0.75" weight="1">
			<parameter idref="CP2.kappa"/>
		</scaleOperator>
		<scaleOperator scaleFactor="0.75" weight="1">
			<parameter idref="CP3.kappa"/>
		</scaleOperator>
		<scaleOperator scaleFactor="0.75" weight="1">
			<parameter idref="CP1.alpha"/>
		</scaleOperator>
		<scaleOperator scaleFactor="0.75" weight="1">
			<parameter idref="CP2.alpha"/>
		</scaleOperator>
		<scaleOperator scaleFactor="0.75" weight="1">
			<parameter idref="CP3.alpha"/>
		</scaleOperator>
		<deltaExchange delta="0.01" weight="1">
			<parameter idref="CP1.frequencies"/>
		</deltaExchange>
		<deltaExchange delta="0.01" weight="1">
			<parameter idref="CP2.frequencies"/>
		</deltaExchange>
		<deltaExchange delta="0.01" weight="1">
			<parameter idref="CP3.frequencies"/>
		</deltaExchange>
		<deltaExchange delta="0.75" parameterWeights="140 140 140" weight="3">
			<parameter idref="allMus"/>
		</deltaExchange>
		<subtreeSlide size="1.0" gaussian="true" weight="15">
			<treeModel idref="treeModel"/>
		</subtreeSlide>
		<narrowExchange weight="15">
			<treeModel idref="treeModel"/>
		</narrowExchange>
		<wideExchange weight="3">
			<treeModel idref="treeModel"/>
		</wideExchange>
		<wilsonBalding weight="3">
			<treeModel idref="treeModel"/>
		</wilsonBalding>
		<scaleOperator scaleFactor="0.75" weight="3">
			<parameter idref="treeModel.rootHeight"/>
		</scaleOperator>
		<uniformOperator weight="30">
			<parameter idref="treeModel.internalNodeHeights"/>
		</uniformOperator>
		<scaleOperator scaleFactor="0.75" weight="3">
			<parameter idref="constant.popSize"/>
		</scaleOperator>
		
	</operators>

	<!-- Define MCMC                                                             -->
	<mcmc id="mcmc" chainLength="20000000" autoOptimize="true" operatorAnalysis="LV_v3.ops">
		<posterior id="posterior">
			<prior id="prior">
				<booleanLikelihood>
					<monophylyStatistic idref="monophyly(HIVM)"/>
					<monophylyStatistic idref="monophyly(drill)"/>
				</booleanLikelihood>
				<normalPrior mean="8.5E-5" stdev="5.0E-6">
					<statistic idref="tmrca(HIVM)"/>
				</normalPrior>
				<exponentialPrior mean="0.001" offset="0.01">
					<statistic idref="tmrca(drill)"/>
				</exponentialPrior>
				<logNormalPrior mean="1.0" stdev="1.25" offset="0.0" meanInRealSpace="false">
					<parameter idref="CP1.kappa"/>
				</logNormalPrior>
				<logNormalPrior mean="1.0" stdev="1.25" offset="0.0" meanInRealSpace="false">
					<parameter idref="CP2.kappa"/>
				</logNormalPrior>
				<logNormalPrior mean="1.0" stdev="1.25" offset="0.0" meanInRealSpace="false">
					<parameter idref="CP3.kappa"/>
				</logNormalPrior>
				<uniformPrior lower="0.0" upper="1.0">
					<parameter idref="CP1.frequencies"/>
				</uniformPrior>
				<uniformPrior lower="0.0" upper="1.0">
					<parameter idref="CP2.frequencies"/>
				</uniformPrior>
				<uniformPrior lower="0.0" upper="1.0">
					<parameter idref="CP3.frequencies"/>
				</uniformPrior>

				<exponentialPrior mean="0.5" offset="0.0">
					<parameter idref="CP1.alpha"/>
				</exponentialPrior>
				<exponentialPrior mean="0.5" offset="0.0">
					<parameter idref="CP2.alpha"/>
				</exponentialPrior>
				<exponentialPrior mean="0.5" offset="0.0">
					<parameter idref="CP3.alpha"/>
				</exponentialPrior>

				<!-- Improper uniform prior: allMus                                          -->
               	<multivariateNormalPrior idref="rate.prior.effects"/>
               	<distributionLikelihood idref="ratesPrior"/> <!-- PRIOR ADDED -->
				<distributionLikelihood idref="scalePrior"/> <!-- PRIOR ADDED -->

				<oneOnXPrior>
					<parameter idref="constant.popSize"/>
				</oneOnXPrior>
				<coalescentLikelihood idref="coalescent"/>
				<rateEpochBranchRates idref="epochRates"/>
			</prior>
			<likelihood id="likelihood">
				<treeLikelihood idref="CP1.treeLikelihood"/>
				<treeLikelihood idref="CP2.treeLikelihood"/>
				<treeLikelihood idref="CP3.treeLikelihood"/>
			</likelihood>
		</posterior>
		<operators idref="operators"/>

		<!-- write log to screen                                                     -->
		<log id="screenLog" logEvery="1000">
			<column label="Posterior" dp="4" width="12">
				<posterior idref="posterior"/>
			</column>
			<column label="Prior" dp="4" width="12">
				<prior idref="prior"/>
			</column>
			<column label="Likelihood" dp="4" width="12">
				<likelihood idref="likelihood"/>
			</column>
			<column label="rootHeight" sf="6" width="12">
				<parameter idref="treeModel.rootHeight"/>
			</column>
			<column label="clock.rates.scale" sf="6" width="12">
				<parameter idref="clock.rates.scale"/>
			</column>
			<column label="epochIntercept" sf="6" width="12">
				<parameter idref="epochIntercept"/>
			</column>
			<column label="fixed" sf="6" width="12">
				<parameter idref="fixedTo1"/>
			</column>
			<column label="epochCoefficient" sf="6" width="12">
				<parameter idref="epochCoefficient"/>
			</column>
		</log>

		<!-- write log to file                                                       -->
		<log id="fileLog" logEvery="1000" fileName="LV_randomrates_gss.log" overwrite="false">
			<posterior idref="posterior"/>
			<prior idref="prior"/>
			<likelihood idref="likelihood"/>
			<parameter idref="treeModel.rootHeight"/>
			<tmrcaStatistic idref="tmrca(HIVM)"/>
			<tmrcaStatistic idref="tmrca(drill)"/>
			<parameter idref="CP1.kappa"/>
			<parameter idref="CP2.kappa"/>
			<parameter idref="CP3.kappa"/>
			<parameter idref="CP1.alpha"/>
			<parameter idref="CP2.alpha"/>
			<parameter idref="CP3.alpha"/>
			<parameter idref="CP1.frequencies"/>
			<parameter idref="CP2.frequencies"/>
			<parameter idref="CP3.frequencies"/>
			<compoundParameter idref="allMus"/>
			
			<parameter idref="epochIntercept"/>
			<parameter idref="epochCoefficient"/>
			<parameter idref="fixedEffects"/>
			<parameter idref="clock.rates.scale"/>
			<parameter idref="clock.rates"/>

			<treeLikelihood idref="CP1.treeLikelihood"/>
			<treeLikelihood idref="CP2.treeLikelihood"/>
			<treeLikelihood idref="CP3.treeLikelihood"/>
			<arbitraryBranchRates idref="branchRates"/>
			<coalescentLikelihood idref="coalescent"/>
			
			<distributionLikelihood idref="ratesPrior"/> <!-- PRIOR ADDED -->
			<distributionLikelihood idref="scalePrior"/> <!-- PRIOR ADDED -->
			<rateEpochBranchRates idref="epochRates"/>
			<parameter idref="constant.popSize"/>

		</log>

		<!-- write tree log to file                                                  -->
		<logTree id="treeFileLog" logEvery="1000" nexusFormat="true" fileName="LV_randomrates_gss.trees" sortTranslationTable="true">
			<treeModel idref="treeModel"/>
			<trait name="rate" tag="rate">
				<arbitraryBranchRates idref="branchRates"/>
			</trait>
			<posterior idref="posterior"/>
		</logTree>
	</mcmc>

	<!-- START Marginal Likelihood Estimator                                     -->

	<!-- A working prior for the constant population size model.                 -->
	<constantSize id="constantReference" units="years">
		<populationSize>
			<parameter id="constantReference.popSize" parameterColumn="constant.popSize" fileName="LV_randomrates_gss.log" burnin="1000000"/>
		</populationSize>
	</constantSize>

	<!-- A working prior for the coalescent.                                     -->
	<coalescentLikelihood id="coalescentReference">
		<model>
			<constantSize idref="constantReference"/>
		</model>
		<populationTree>
			<treeModel idref="treeModel"/>
		</populationTree>
	</coalescentLikelihood>

	<!-- Define marginal likelihood estimator (PS/SS) settings                   -->
	<marginalLikelihoodEstimator chainLength="2000000" pathSteps="100" pathScheme="betaquantile" alpha="0.3" printOperatorAnalysis="true">
		<samplers>
			<mcmc idref="mcmc"/>
		</samplers>
		<pathLikelihood id="pathLikelihood">
			<source>
				<posterior idref="posterior"/>
			</source>
			<destination>
				<workingPrior>
				
					<booleanLikelihood>
						<monophylyStatistic idref="monophyly(HIVM)"/>
						<monophylyStatistic idref="monophyly(drill)"/>
					</booleanLikelihood>

					<normalPrior mean="8.5E-5" stdev="5.0E-6">
						<statistic idref="tmrca(HIVM)"/>
					</normalPrior>
					<exponentialPrior mean="0.001" offset="0.01">
						<statistic idref="tmrca(drill)"/>
					</exponentialPrior>
				
					<logTransformedNormalReferencePrior fileName="LV_randomrates_gss.log" parameterColumn="CP1.kappa" burnin="4000000">
						<parameter idref="CP1.kappa"/>
					</logTransformedNormalReferencePrior>
					<logTransformedNormalReferencePrior fileName="LV_randomrates_gss.log" parameterColumn="CP2.kappa" burnin="4000000">
						<parameter idref="CP2.kappa"/>
					</logTransformedNormalReferencePrior>
					<logTransformedNormalReferencePrior fileName="LV_randomrates_gss.log" parameterColumn="CP3.kappa" burnin="4000000">
						<parameter idref="CP3.kappa"/>
					</logTransformedNormalReferencePrior>

					<logTransformedNormalReferencePrior fileName="LV_randomrates_gss.log" parameterColumn="CP1.alpha" burnin="4000000">
						<parameter idref="CP1.alpha"/>
					</logTransformedNormalReferencePrior>
					<logTransformedNormalReferencePrior fileName="LV_randomrates_gss.log" parameterColumn="CP2.alpha" burnin="4000000">
						<parameter idref="CP2.alpha"/>
					</logTransformedNormalReferencePrior>
					<logTransformedNormalReferencePrior fileName="LV_randomrates_gss.log" parameterColumn="CP3.alpha" burnin="4000000">
						<parameter idref="CP3.alpha"/>
					</logTransformedNormalReferencePrior>
					
					<logitTransformedNormalReferencePrior fileName="LV_randomrates_gss.log" parameterColumn="CP1.frequencies" dimension="4" burnin="4000000">
						<parameter idref="CP1.frequencies"/>
					</logitTransformedNormalReferencePrior>
					<logitTransformedNormalReferencePrior fileName="LV_randomrates_gss.log" parameterColumn="CP2.frequencies" dimension="4" burnin="4000000">
						<parameter idref="CP2.frequencies"/>
					</logitTransformedNormalReferencePrior>
					<logitTransformedNormalReferencePrior fileName="LV_randomrates_gss.log" parameterColumn="CP3.frequencies" dimension="4" burnin="4000000">
						<parameter idref="CP3.frequencies"/>
					</logitTransformedNormalReferencePrior>

					<logitTransformedNormalReferencePrior fileName="LV_randomrates_gss.log" parameterColumn="CP1.mu" upperLimit="3.0" burnin="4000000">
						<parameter idref="CP1.mu"/>
					</logitTransformedNormalReferencePrior>
					<logitTransformedNormalReferencePrior fileName="LV_randomrates_gss.log" parameterColumn="CP2.mu" upperLimit="3.0" burnin="4000000">
						<parameter idref="CP2.mu"/>
					</logitTransformedNormalReferencePrior>
					<logitTransformedNormalReferencePrior fileName="LV_randomrates_gss.log" parameterColumn="CP3.mu" upperLimit="3.0" burnin="4000000">
						<parameter idref="CP3.mu"/>
					</logitTransformedNormalReferencePrior>

					<logTransformedNormalReferencePrior fileName="LV_randomrates_gss.log" parameterColumn="constant.popSize" burnin="1000000">
						<parameter idref="constant.popSize"/>
					</logTransformedNormalReferencePrior>
					
					<logTransformedNormalReferencePrior id="wprior_clock_rates_scale" fileName="LV_randomrates_gss.log" parameterColumn="clock.rates.scale" burnin="4000000">
						<parameter idref="clock.rates.scale"/>
					</logTransformedNormalReferencePrior>
					
					<!-- <distributionLikelihood idref="epochCoefficientPrior"/>  PRIOR ADDED -->
					<normalReferencePrior id="wprior_epochIntercept" fileName="LV_randomrates_gss.log" parameterColumn="epochIntercept" burnin="4000000">
						<parameter idref="epochIntercept"/>
					</normalReferencePrior>
					<normalReferencePrior id="wprior_epochepochCoefficient" fileName="LV_randomrates_gss.log" parameterColumn="epochCoefficient" burnin="4000000">
						<parameter idref="epochCoefficient"/>
					</normalReferencePrior>
					
					<distributionLikelihood idref="ratesPrior"/> 

					
					<rateEpochBranchRates idref="epochRates"/>
					<coalescentLikelihood idref="coalescentReference"/>
				
				</workingPrior>
			</destination>
		</pathLikelihood>
		<log id="MLELog" logEvery="500" fileName="LV_randomrates_gss.mle.log">
			<pathLikelihood idref="pathLikelihood"/>
		</log>
	</marginalLikelihoodEstimator>

	<!-- Generalized stepping-stone sampling estimator from collected samples    -->
	<generalizedSteppingStoneSamplingAnalysis fileName="LV_randomrates_gss.mle.log" resultsFileName="LV_randomrates_gss.mle.result.log">
		<sourceColumn name="pathLikelihood.source"/>
		<destinationColumn name="pathLikelihood.destination"/>
		<thetaColumn name="pathLikelihood.theta"/>
	</generalizedSteppingStoneSamplingAnalysis>

	<report>
		<property name="timer">
			<mcmc idref="mcmc"/>
		</property>
	</report>
</beast>
